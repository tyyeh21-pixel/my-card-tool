<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆ·å¡å¿«æœ 2.0</title>
    <style>
        :root {
            --primary: #007AFF;
            --bg: #f5f5f7;
            --card-bg: #ffffff;
            --text: #1d1d1f;
            --sub-text: #86868b;
            --warning: #ff3b30;
            --highlight: #5856d6; /* ç´«è‰²ï¼Œç”¨æ–¼ CUBE æ–¹æ¡ˆ */
            --tag-bg: #f2f2f7;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 { font-size: 1.4rem; margin-bottom: 20px; font-weight: 800; }

        /* æœå°‹å€å¡Š */
        .search-container {
            width: 100%;
            max-width: 450px;
            margin-bottom: 25px;
            position: sticky;
            top: 10px;
            z-index: 100;
        }

        input[type="search"] {
            width: 100%;
            padding: 16px;
            font-size: 18px;
            border-radius: 14px;
            border: 1px solid rgba(0,0,0,0.1);
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.06);
            box-sizing: border-box;
        }
        
        input[type="search"]:focus {
            outline: 2px solid var(--primary);
        }

        /* çµæœåˆ—è¡¨ */
        #result-area {
            width: 100%;
            max-width: 450px;
            padding-bottom: 50px;
        }

        .result-title {
            margin: 10px 0 10px 5px;
            font-size: 0.9rem;
            color: var(--sub-text);
            font-weight: 600;
        }

        /* å¡ç‰‡æœ¬é«” */
        .card {
            background: var(--card-bg);
            border-radius: 18px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.03);
            border: 1px solid rgba(0,0,0,0.03);
            position: relative;
            overflow: hidden;
            transition: transform 0.2s;
        }
        
        /* å† è»å¡ç‰‡ç‰¹æ•ˆ */
        .card.best-match {
            border: 2px solid var(--primary);
            background: #fff;
            box-shadow: 0 8px 25px rgba(0,122,255,0.12);
            transform: scale(1.02);
        }
        
        .card.best-match::after {
            content: "ğŸ‘‘ æ¨è–¦";
            position: absolute;
            top: 0;
            right: 0;
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            font-size: 0.8rem;
            border-bottom-left-radius: 12px;
            font-weight: bold;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 5px;
        }

        .card-name { font-size: 1.25rem; font-weight: 800; color: #000; }
        .rate { font-size: 1.6rem; font-weight: 900; color: var(--primary); }

        /* CUBE æ–¹æ¡ˆèˆ‡æ”¯ä»˜æ–¹å¼æ¨™ç±¤ */
        .tags-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
        }

        .badge {
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .badge-scheme {
            background-color: #f3f2ff;
            color: var(--highlight);
            border: 1px solid #dcdaff;
        }
        
        .badge-method {
            background-color: var(--tag-bg);
            color: #333;
        }

        /* è©³ç´°è³‡è¨Šå€ */
        .details {
            background-color: #f9f9f9;
            padding: 12px;
            border-radius: 10px;
            font-size: 0.9rem;
        }

        .detail-row {
            margin-bottom: 6px;
            display: flex;
            align-items: flex-start;
        }
        
        .detail-row:last-child { margin-bottom: 0; }
        
        .icon { margin-right: 6px; min-width: 18px; }
        
        .limit-text { color: var(--warning); }
        .period-text { color: var(--sub-text); font-size: 0.85rem; }

    </style>
</head>
<body>

    <h1>åˆ·å¡æ”»ç•¥ 2.0</h1>

    <div class="search-container">
        <input type="search" id="search-input" list="merchant-list" placeholder="è¼¸å…¥ï¼šèª å“, 7-11, æ—¥æœ¬...">
        
        <datalist id="merchant-list">
            <option value="èª å“ç”Ÿæ´»">
            <option value="SOGO / æ–°å…‰ä¸‰è¶Š">
            <option value="7-11 / å…¨å®¶">
            <option value="æ—¥æœ¬æµ·å¤–">
            <option value="Agoda / è¨‚æˆ¿">
            <option value="é«˜éµ / å°éµ">
            <option value="å…¨è¯">
            <option value="ä¿è²»">
        </datalist>
    </div>

    <div id="result-area">
        </div>

    <script>
        // -----------------------------------------------------------
        // è³‡æ–™åº«è¨­å®šå€
        // sortVal: ç”¨æ–¼æ’åºï¼Œæ•¸å­—è¶Šå¤§æ’è¶Šå‰é¢ (å“©ç¨‹å¡å»ºè­°è¨­ 3~5 ä¹‹é–“)
        // scheme: å°ˆç”¨æ–¼ CUBE å¡çš„æ–¹æ¡ˆåç¨±ï¼Œæ²’æœ‰å‰‡å¡« null
        // -----------------------------------------------------------
        const rules = [
            // --- èª å“ / ç™¾è²¨ (ç¯„ä¾‹ï¼šCUBE æ¨‚é¥—è³¼ vs å¤§æˆ¶) ---
            {
                keywords: ["èª å“", "eslite", "ç™¾è²¨", "sogo", "æ–°å…‰ä¸‰è¶Š", "é æ±"],
                cardName: "åœ‹æ³° CUBE å¡",
                scheme: "åˆ‡æ›ã€æ¨‚é¥—è³¼ã€‘", 
                method: "å¯¦é«”å¡ / Apple Pay",
                rate: "3%",
                sortVal: 3.0,
                limit: "å›é¥‹ç„¡ä¸Šé™ (å°æ¨¹é»)",
                period: "2026/1/1 ~ 2026/6/30"
            },
            {
                keywords: ["èª å“", "eslite", "ç™¾è²¨", "é¤å»³"],
                cardName: "æ°¸è±å¤§æˆ¶å¡",
                scheme: null,
                method: "å¯¦é«”å¡ / Apple Pay",
                rate: "2%~7%",
                sortVal: 2.5, // é›–ç„¶æœ€é«˜7%ï¼Œä½†å¤§æˆ¶æœ‰ä¸Šé™ï¼Œæ‰€ä»¥æˆ‘è¨­æ¯”Cubeä½ä¸€é»ï¼Œè®“Cubeæ’ç¬¬ä¸€
                limit: "åœ‹å…§1%ç„¡ä¸Šé™ + 1%ä»»å‹™ + 5%æŒ‡å®š(ä¸Šé™300å…ƒ/æœˆ)",
                period: "2026/1/1 ~ 2026/6/30"
            },
            {
                keywords: ["èª å“", "eslite", "ç™¾è²¨"],
                cardName: "ç‰å±±åœ‹æ—…å¡",
                scheme: null,
                method: "å¯¦é«”å¡",
                rate: "1%",
                sortVal: 1.0,
                limit: "ç¾é‡‘å›é¥‹ç„¡ä¸Šé™",
                period: "é•·æœŸæœ‰æ•ˆ"
            },

            // --- è¶…å•† / Line Pay ---
            {
                keywords: ["7-11", "å…¨å®¶", "è¶…å•†", "line pay", "linepay"],
                cardName: "å°æ–° GoGo",
                scheme: null,
                method: "ç¶å®š Line Pay",
                rate: "3.8%",
                sortVal: 3.8,
                limit: "ä¸Šé™ $1000/æœˆ (åˆ· $30,303 å°é ‚)",
                period: "2025/12/1 ~ 2026/5/31"
            },
            {
                keywords: ["7-11", "å…¨å®¶", "è¶…å•†"],
                cardName: "åœ‹æ³° CUBE å¡",
                scheme: "åˆ‡æ›ã€é›†ç²¾é¸ã€‘",
                method: "OPENéŒ¢åŒ… / FamiPay",
                rate: "3%",
                sortVal: 3.0,
                limit: "æ³¨æ„ï¼šå¯¦é«”å¡/Apple Pay æ²’å›é¥‹ï¼Œè¦ç”¨ç¶å®šéŒ¢åŒ…",
                period: "2026/1/1 ~ 2026/6/30"
            },

            // --- æ—¥æœ¬ / æµ·å¤–æ—…éŠ ---
            {
                keywords: ["æ—¥æœ¬", "éŸ“åœ‹", "æµ·å¤–", "åœ‹å¤–"],
                cardName: "åŒ¯è±æ—…äººç„¡é™",
                scheme: null,
                method: "å¯¦é«”å¡",
                rate: "10å…ƒ/å“©",
                sortVal: 4.5, // æˆ‘æŠŠå“©ç¨‹åƒ¹å€¼è¨­å¾ˆé«˜ï¼Œè®“å®ƒæ’ç¬¬ä¸€
                limit: "ç„¡ä¸Šé™ï¼Œæœ€å„ªè§£",
                period: "é•·æœŸæœ‰æ•ˆ"
            },
            {
                keywords: ["æ—¥æœ¬", "éŸ“åœ‹", "æµ·å¤–"],
                cardName: "åœ‹æ³° CUBE å¡",
                scheme: "åˆ‡æ›ã€è¶£æ—…è¡Œã€‘",
                method: "å¯¦é«”å¡",
                rate: "3%",
                sortVal: 3.0,
                limit: "å›é¥‹ç„¡ä¸Šé™ (å°æ¨¹é»)",
                period: "2026/1/1 ~ 2026/6/30"
            },

            // --- äº¤é€š (é«˜éµ) ---
            {
                keywords: ["é«˜éµ", "å°éµ"],
                cardName: "åœ‹æ³° CUBE å¡",
                scheme: "åˆ‡æ›ã€é›†ç²¾é¸ã€‘", // å‡è¨­é›†ç²¾é¸æœ‰é«˜éµ
                method: "å¯¦é«”å¡ / Apple Pay",
                rate: "3%",
                sortVal: 3.0,
                limit: "ç„¡ä¸Šé™",
                period: "2026/1/1 ~ 2026/6/30"
            },

            // --- å…œåº• (General) ---
            {
                keywords: ["default"],
                cardName: "åŒ¯è±æ—…äººç„¡é™",
                scheme: null,
                method: "å¯¦é«”å¡",
                rate: "18å…ƒ/å“©",
                sortVal: 2.0,
                limit: "åœ‹å…§ç„¡è…¦åˆ·",
                period: "é•·æœŸæœ‰æ•ˆ"
            },
            {
                keywords: ["default"],
                cardName: "æ°¸è±å¤§æˆ¶",
                scheme: null,
                method: "å¯¦é«”å¡",
                rate: "2%",
                sortVal: 1.5,
                limit: "éœ€å¤§æˆ¶ç­‰ç´š (1%ç„¡ä¸Šé™+1%ä¸Šé™600å…ƒ)",
                period: "2026/1/1 ~ 2026/6/30"
            }
        ];

        // -----------------------------------------------------------
        // ç¨‹å¼é‚è¼¯å€
        // -----------------------------------------------------------
        const input = document.getElementById('search-input');
        const resultArea = document.getElementById('result-area');

        window.onload = () => findBestCard("");

        input.addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase().trim();
            findBestCard(query);
        });

        function findBestCard(query) {
            resultArea.innerHTML = "";
            let matches = [];
            let isGeneral = false;

            if (!query) {
                matches = rules.filter(r => r.keywords.includes("default"));
                resultArea.innerHTML += `<div class="result-title">ğŸŒŸ ç„¡ç‰¹å®šé€šè·¯ï¼Ÿæ¨è–¦ç„¡è…¦åˆ·ï¼š</div>`;
                isGeneral = true;
            } else {
                matches = rules.filter(rule => {
                    return rule.keywords.some(k => query.includes(k) || k.includes(query));
                });

                if (matches.length === 0) {
                    matches = rules.filter(r => r.keywords.includes("default"));
                    resultArea.innerHTML += `<div class="result-title">ğŸ¤” æ‰¾ä¸åˆ° "${input.value}"ï¼Œå»ºè­°ä½¿ç”¨ï¼š</div>`;
                    isGeneral = true;
                } else {
                    resultArea.innerHTML += `<div class="result-title">ğŸ” "${input.value}" æœ€ä½³åˆ·å¡ç­–ç•¥ï¼š</div>`;
                }
            }

            // --- é—œéµæ’åºé‚è¼¯ ---
            // ä¾ç…§ sortVal ç”±å¤§åˆ°å°æ’åº
            matches.sort((a, b) => b.sortVal - a.sortVal);

            matches.forEach((card, index) => {
                const isBest = (!isGeneral && index === 0) ? 'best-match' : '';
                
                // è™•ç† Scheme æ¨™ç±¤ (å¦‚æœæœ‰æ‰é¡¯ç¤º)
                const schemeHtml = card.scheme 
                    ? `<span class="badge badge-scheme">ğŸ“± ${card.scheme}</span>` 
                    : '';

                const html = `
                    <div class="card ${isBest}">
                        <div class="card-header">
                            <div class="card-name">${card.cardName}</div>
                            <div class="rate">${card.rate}</div>
                        </div>
                        
                        <div class="tags-row">
                            ${schemeHtml}
                            <span class="badge badge-method">ğŸ’³ ${card.method}</span>
                        </div>

                        <div class="details">
                            <div class="detail-row">
                                <span class="icon">âš ï¸</span>
                                <span class="limit-text">${card.limit}</span>
                            </div>
                            <div class="detail-row">
                                <span class="icon">ğŸ“…</span>
                                <span class="period-text">é©ç”¨ï¼š${card.period}</span>
                            </div>
                        </div>
                    </div>
                `;
                resultArea.innerHTML += html;
            });
        }
    </script>
</body>
</html>
